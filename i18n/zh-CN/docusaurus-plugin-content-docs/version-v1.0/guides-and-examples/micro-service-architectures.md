---
title: Feature Flags and the Micro-Service Architecture
---

## 问题背景

有时很难确定如何将Flagsmith项目映射到自己的应用程序。当您开发一个具有单一核心服务器端服务的应用时，通常很明显可以将一个Flagsmith项目对应到您的服务器端应用。

但在微服务架构中情况会变得复杂。假设您有5个微服务共同支撑前端应用，这时应该为所有服务创建单个Flagsmith项目？还是为每个服务单独创建项目？亦或是折中方案？

## 解决方案

正如软件工程中的许多问题，正确答案是"视情况而定"。这虽然不算最明确的答案，但绝对是最准确的！核心考量因素是服务间的耦合程度。

通常来说，如果一组微服务是紧密耦合的，它们就适合共享单个Flagsmith项目。反之，如果服务间是松耦合且有明确定义的接口边界，则建议采用"一个微服务对应一个Flagsmith项目"的映射方式。

### 原因解析

这本质上取决于接口边界。如果您开发的服务具有已确立的API接口，那么调用该API的服务并不需要关心具体实现细节。既然如此，它们也不应该过多关注您的功能开关——这有什么必要呢？

反观紧密耦合的服务场景。假设三个微服务共享同一个数据库，当您需要修改数据库schema时，就必须协调三个服务的新schema代码。这种部署协调充满风险，而使用功能开关就是绝佳的解决方案。这种情况下，让三个微服务共享同一个Flagsmith项目会非常有利。

### 其他考量因素

若使用单个Flagsmith项目支撑多个微服务，还需注意以下方面：

项目所有成员都将拥有功能开关的访问权限。如果其他团队的工程师本不应操作您的生产环境开关，这可能就是需要拆分为多个Flagsmith项目的信号。

当微服务之间需要共享用户分群定义时，采用单一Flagsmith项目会更便利。如果用户访问各服务的上下文环境相同或相似，共享分群就非常合理。