---
title: Feature Flags and the Micro-Service Architecture
---

## 问题背景

有时很难确定如何将Flagsmith项目映射到您自己的应用程序。当您开发一个具有单一核心服务器端服务的应用时，通常很明显可以将1个Flagsmith项目对应到您的服务器端应用。

但当您开始使用微服务架构时，情况会变得复杂。假设您有5个微服务共同支撑前端应用，这时应该为所有5个服务创建单个Flagsmith项目？还是为每个服务创建5个独立项目？亦或是折中方案？

## 解决方案

正如软件工程中的许多问题，正确答案是"视情况而定"。这个回答可能不够具体，但绝对是最准确的！核心问题在于耦合度。

通常，如果一组微服务是紧密耦合的，它们可能适合共享单个Flagsmith项目。反之，如果服务间是松耦合且具有明确定义的接口边界，则建议采用1个Flagsmith项目对应1个微服务的模式。

### 原因何在？

这本质上取决于接口边界。如果您开发的服务具有已达成共识的API接口，那么消费该API的服务并不需要过多关注实现细节。既然如此，它们也不应该过度关注您的功能开关，这合情合理。

另一方面，如果您开发的服务与其他服务紧密耦合，您确实需要关注它们的开关状态。举例说明：假设三个微服务共享同一个数据库，当您需要修改数据库schema时，必须协调三个服务同步更新schema代码。这种部署协调充满风险，而使用功能开关就能优雅解决这个问题。这种情况下，让三个微服务共享同一个Flagsmith项目就非常实用。

### 其他考量因素

若使用单个Flagsmith项目支撑多个微服务，您需要注意以下方面：

项目所有成员都将拥有功能开关的管理权限。如果其他团队的工程师无需操作您的生产环境开关，这可能意味着需要拆分为独立的Flagsmith项目。

当微服务之间需要共享用户分群定义时，采用单一Flagsmith项目会更具优势。如果用户访问不同服务的上下文相似，共享分群逻辑就非常合理。